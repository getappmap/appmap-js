{"version":3,"file":"NodeClient.js","sourceRoot":"","sources":["../../Library/NodeClient.ts"],"names":[],"mappings":";;;;;;;;;;;;;;AAEA,mDAAsD;AACtD,sEAAyE;AACzE,0EAA6E;AAC7E,mCAAsC;AAGtC;;;;;GAKG;AACH;IAAyB,8BAAe;IAAxC;;IA6CA,CAAC;IA3CG;;;;;OAKG;IACI,6CAAwB,GAA/B,UAAgC,SAA6C;QACzE,IAAI,SAAS,IAAI,SAAS,CAAC,OAAO,IAAI,SAAS,CAAC,QAAQ,IAAI,SAAS,CAAC,QAAQ,EAAE;YAC5E,qBAAqB,CAAC,gBAAgB,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC;SAC3D;aAAM;YACH,OAAO,CAAC,IAAI,CAAC,kHAAkH,CAAC,CAAC;SACpI;IACL,CAAC;IAED;;;;OAIG;IACI,yCAAoB,GAA3B,UAA4B,SAA6C;QACrE,IAAI,SAAS,CAAC,QAAQ,IAAI,SAAS,CAAC,KAAK,EAAE;YACvC,OAAO,CAAC,IAAI,CAAC,4IAA4I,CAAC,CAAC;SAC9J;QACD,IAAI,SAAS,IAAI,SAAS,CAAC,OAAO,IAAI,SAAS,CAAC,QAAQ,EAAE;YACtD,qBAAqB,CAAC,YAAY,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC;SACvD;aAAM;YACH,OAAO,CAAC,IAAI,CAAC,oGAAoG,CAAC,CAAC;SACtH;IACL,CAAC;IAED;;;;OAIG;IACI,4CAAuB,GAA9B,UAA+B,SAAgD;QAC3E,IAAI,SAAS,IAAI,SAAS,CAAC,OAAO,EAAE;YAChC,qBAAqB,CAAC,YAAY,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC;SACvD;aACI;YACD,OAAO,CAAC,IAAI,CAAC,6FAA6F,CAAC,CAAC;SAC/G;IACL,CAAC;IACL,iBAAC;AAAD,CAAC,AA7CD,CAAyB,eAAe,GA6CvC;AAED,iBAAS,UAAU,CAAA","sourcesContent":["import http = require(\"http\");\r\nimport https = require(\"https\");\r\nimport TelemetryClient = require(\"./TelemetryClient\");\r\nimport ServerRequestTracking = require(\"../AutoCollection/HttpRequests\");\r\nimport ClientRequestTracking = require(\"../AutoCollection/HttpDependencies\");\r\nimport Logging = require(\"./Logging\");\r\nimport Contracts = require(\"../Declarations/Contracts\");\r\n\r\n/**\r\n * Application Insights Telemetry Client for Node.JS. Provides the Application Insights TelemetryClient API\r\n * in addition to Node-specific helper functions.\r\n * Construct a new TelemetryClient to have an instance with a different configuration than the default client.\r\n * In most cases, `appInsights.defaultClient` should be used instead.\r\n */\r\nclass NodeClient extends TelemetryClient {\r\n\r\n    /**\r\n     * Log RequestTelemetry from HTTP request and response. This method will log immediately without waiting for request completion\r\n     * and it requires duration parameter to be specified on NodeHttpRequestTelemetry object.\r\n     * Use trackNodeHttpRequest function to log the telemetry after request completion\r\n     * @param telemetry Object encapsulating incoming request, response and duration information \r\n     */\r\n    public trackNodeHttpRequestSync(telemetry: Contracts.NodeHttpRequestTelemetry) {\r\n        if (telemetry && telemetry.request && telemetry.response && telemetry.duration) {\r\n            ServerRequestTracking.trackRequestSync(this, telemetry);\r\n        } else {\r\n            Logging.warn(\"trackNodeHttpRequestSync requires NodeHttpRequestTelemetry object with request, response and duration specified.\");\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Log RequestTelemetry from HTTP request and response. This method will `follow` the request to completion.\r\n     * Use trackNodeHttpRequestSync function to log telemetry immediately without waiting for request completion\r\n     * @param telemetry Object encapsulating incoming request and response information\r\n     */\r\n    public trackNodeHttpRequest(telemetry: Contracts.NodeHttpRequestTelemetry) {\r\n        if (telemetry.duration || telemetry.error) {\r\n            Logging.warn(\"trackNodeHttpRequest will ignore supplied duration and error parameters. These values are collected from the request and response objects.\");\r\n        }\r\n        if (telemetry && telemetry.request && telemetry.response) {\r\n            ServerRequestTracking.trackRequest(this, telemetry);\r\n        } else {\r\n            Logging.warn(\"trackNodeHttpRequest requires NodeHttpRequestTelemetry object with request and response specified.\");\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Log DependencyTelemetry from outgoing HTTP request. This method will instrument the outgoing request and append\r\n     * the specified headers and will log the telemetry when outgoing request is complete\r\n     * @param telemetry Object encapsulating outgoing request information\r\n     */\r\n    public trackNodeHttpDependency(telemetry: Contracts.NodeHttpDependencyTelemetry) {\r\n        if (telemetry && telemetry.request) {\r\n            ClientRequestTracking.trackRequest(this, telemetry);\r\n        }\r\n        else {\r\n            Logging.warn(\"trackNodeHttpDependency requires NodeHttpDependencyTelemetry object with request specified.\");\r\n        }\r\n    }\r\n}\r\n\r\nexport = NodeClient"]}